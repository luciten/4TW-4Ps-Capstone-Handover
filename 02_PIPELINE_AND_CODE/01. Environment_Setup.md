# ENVIRONMENT SETUP SUMMARY

## Overview
This document outlines the required tools, versions, configurations, and environment variables needed to run the project’s data pipeline locally. Once set up, this should allow the team to fully replicate the pipeline during ingestion or dbt model execution.

---

# Required Software
- WSL (Ubuntu)
- Python
- Git
- Docker
- DBeaver
- Metabase
- uv (Python environment manager)

---

# WSL (Ubuntu)

Install WSL:  
https://learn.microsoft.com/en-us/windows/wsl/install

Quick install (PowerShell as Admin):
```powershell
wsl --install
```

Update Ubuntu:
```update
sudo apt update && sudo apt upgrade -y
```

# Python
Ubuntu
```
sudo apt update
sudo apt install -y python3 python3-venv python3-pip
python3 --version
```
```
macOS (Homebrew)
brew install python
python3 --version
```
Verify:
```
python --version
```

# Git
Install: https://git-scm.com/install
Ubuntu
```
sudo apt install git -y
git --version
```
macOS
```
brew install git
git --version
```
Configure:
```
git config --global user.name "Your Name"
git config --global user.email "you@example.com"
git config --global init.defaultBranch main
git config --global pull.rebase false
git config --global core.autocrlf input
```
Windows:
```
git config --global core.autocrlf true
```
Clone:
```
git clone https://github.com/luciten/ftw-de-capstone-project.git
cd ftw-de-capstone-project
```
# Docker
## Option 1 — Docker Desktop
Install:
https://docs.docker.com/desktop/setup/install/windows-install/
WSL Integration → Ubuntu ON
Verify:
```
docker run hello-world
```
## Option 2 — Native Docker Engine (WSL)
Enable systemd:
```
sudo tee /etc/wsl.conf >/dev/null <<'EOF'
[boot]
systemd=true
EOF
```
Restart WSL:
```
wsl --shutdown
Reopen Ubuntu, install dependencies:
sudo apt install -y ca-certificates curl gnupg
```
GPG key:
```
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc
```
Add Docker repo:
```
{% raw %}
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo ${UBUNTU_CODENAME:-$VERSION_CODENAME}) stable" \
  | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
{% endraw %}
```
Install Docker:
```
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```
Enable Docker without sudo:
```
sudo systemctl enable --now docker
sudo usermod -aG docker $USER
newgrp docker
docker run hello-world
```
macOS Docker
```
brew install --cask docker
docker run hello-world
```
# DBeaver
Install:
https://dbeaver.io/download/
macOS:
```
brew install --cask dbeaver-community
```

# uv (Python package manager)
Install:
```
curl -LsSf https://astral.sh/uv/install.sh | sh
```
Verify:
```
uv --version
```
Linux:
```
echo 'export PATH="$HOME/.local/bin:$PATH"' >> ~/.bashrc
source ~/.bashrc
```
macOS:
```
echo 'export PATH="/opt/homebrew/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```
# Project Setup
Clone:
```
git clone https://github.com/luciten/ftw-de-capstone-project
cd ftw-de-capstone-project
```
Create virtual environment (Linux/macOS):
```
uv venv
source .venv/bin/activate
```
Windows:
```
uv venv
source .venv\Scripts\activate
```
Install dependencies:
```
uv pip install -r requirements.txt
```
Deactivate:
```
deactivate
```

# dbt + ClickHouse
profiles.yml
```
default:
  outputs:
    local:
      type: clickhouse
      schema: default
      host: clickhouse
      port: 9000
      user: default
      password: ""
      secure: false
    
    remote:
      type: clickhouse
      schema: mart_grp4
      host: 54.87.106.52
      port: 8123
      user: ftw_grp4
      password: Pika@025!FTW
      threads: 4
      secure: false

  target: "{{ env_var('DBT_TARGET', 'remote') }}"
```
# dbt_project.yml
```
name: 'capstone_project'
version: '1.0.0'
config-version: 2

profile: 'default'

model-paths: ["models"]
analysis-paths: ["analyses"]
test-paths: ["tests"]
seed-paths: ["seeds"]
macro-paths: ["macros"]
snapshot-paths: ["snapshots"]

target-path: "target"
clean-targets:
  - "dbt_packages"
  - "target"
log-path: "logs"

models:
  capstone_project:
    clean:
      +schema: clean_grp4
      +materialized: table
    mart:
      +schema: mart_grp4
      +materialized: view
```
# .env
```
CLICKHOUSE_CONTAINER=clickhouse
CLICKHOUSE_HTTP_PORT=8123
CLICKHOUSE_TCP_PORT=9000

REMOTE_CH_HOST=54.87.106.52
REMOTE_CH_USER=ftw_grp4
REMOTE_CH_PASS=Pika@025!FTW

DLT_CONTAINER=dlt

DBT_CONTAINER=dbt
DBT_TARGET=remote

METABASE_CONTAINER=metabase
METABASE_PORT=3001
```

# ClickHouse (DBeaver)
Host: 54.87.106.52
Port: 8123
Database: default
User: ftw_grp4
Password: Pika@025!FTW

# Troubleshooting
Data not loading
   * Check: Python ingestion scripts → ClickHouse raw tables
   * Tool: DBeaver to inspect raw layer
Transformations failing
   * Check: dbt logs → staging/mart table creation
   * Tool: dbt test, dbt run --debug
Dashboards showing wrong data
   * Check: ClickHouse mart tables → Metabase queries
   * Tool: DBeaver to validate mart layer data
Performance problem
   * Check: ClickHouse query logs → table partitioning → indexes
   * Tool: ClickHouse system tables, EXPLAIN queries
